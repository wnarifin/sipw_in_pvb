# MAR
# P(V=1) = sum{P(V=1|T=t)P(T=t)}
# P(T=t) = sum{P(T=t|D=d)P(D=d)}

# function P(V=1)
p_v1 = function(sn, sp, p, p_v1_t1, p_v1_t0) {
  p_t1 = sn*p + (1-sp)*(1-p)
  p_t0 = (1-sn)*p + sp*(1-p)
  p_v1 = p_v1_t1*p_t1 + p_v1_t0*p_t0
  return(p_v1)
}

# p = 0.4
p_v1(.3,.6,.4,.8,.4)
p_v1(.3,.9,.4,.8,.4)
p_v1(.6,.6,.4,.8,.4)
p_v1(.6,.9,.4,.8,.4)
p_v1(.9,.6,.4,.8,.4)
p_v1(.9,.9,.4,.8,.4)

# p = 0.1
p_v1(.3,.6,.1,.8,.4)
p_v1(.3,.9,.1,.8,.4)
p_v1(.6,.6,.1,.8,.4)
p_v1(.6,.9,.1,.8,.4)
p_v1(.9,.6,.1,.8,.4)
p_v1(.9,.9,.1,.8,.4)
